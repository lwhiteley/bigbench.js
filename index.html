<!DOCTYPE html>
<html>
  <head>
    <title>bigbench.js</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="all">
    <link href="css/docs.css" rel="stylesheet" media="all">
  </head>
  <body data-spy="scroll">
    
    <!-- Navigation -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="./index.html">bigbench.js</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class=""><a href="./index.html">Home</a></li>
              <li><a href="#intro">Intro</a></li>
              <li><a href="#benchmark">Benchmark</a></li>
              <li><a href="#setup">Setup</a></li>
              <li><a href="#control">Control</a></li>
              <li><a href="#data">Data and Events</a></li>
              <li><a href="#examples">Examples</a></li>
            </ul>
            <ul class="nav pull-right">
              <li class=""><a href="./docs/bigbench.html">JS Documentation</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <a href="https://github.com/mwaylabs/bigbench.js"><img style="position: absolute; top: 0; right: 0; border: 0; z-index:2000;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
    
    <!-- Header -->
    <header class="jumbotron subhead" id="overview">
      <div class="container">
        <img src="./img/header.png">
        <div class="row">
          <div class="span6">
            <p class="lead"><strong>bigbench.js</strong> is a distributed load-generation framework for web application benchmarking that collects data in real-time</p>
          </div>
          <div class="span6">
            <p class="lead" style="text-align: center; margin-top: 13px;">
              It's open-source!
              <a href="https://github.com/mwaylabs/bigbench.js" class="btn btn-large btn-primary btn-block">Fork bigbench.js on GitHub</a>
            </p>
          </div>
        </div>
      </div>
    </header>
    
    <!-- Content -->
    <div class="container" style="padding-bottom:60px;">
      
      <ul class="nav nav-list bs-docs-sidenav affix span2" style="margin-left: -300px; margin-top: 50px;" data-spy="affix" data-offset-top="260">
        <li class="active"><a href="#intro"><i class="icon-chevron-right"></i> Intro</a></li>
        <li><a href="#benchmark"><i class="icon-chevron-right"></i> Benchmark</a></li>
        <li><a href="#setup"><i class="icon-chevron-right"></i> Setup</a></li>
        <li><a href="#control"><i class="icon-chevron-right"></i> Control</a></li>
        <li><a href="#data"><i class="icon-chevron-right"></i> Data and Events</a></li>
        <li><a href="#examples"><i class="icon-chevron-right"></i> Examples</a></li>
      </ul>
      
      <section id="intro" class="no-print-break">
        <div class="row">
          <div class="span6">
            <h3>Bot Network</h3>
            <p>The load is generated by a bot network. Multiple bots can be started on a single or multiple machines. This allows the generation of an almost unlimited amount of requests. A ramp-up time allows the bots to start gradually over the specified time period.</p>
        </div>
          <div class="span6">
            <h3>Concurrency</h3>
            <p>The concurrency is controlled by two things: A concurrency parameter and the amount of bots. A concurrency parameter setting of 2 means that each bot starts 2 requests at the same time, waits for the to return and then continues with the next action.</p>
          </div>
        </div>
        <img src="./img/system.png" alt="">
        <div class="row">
          <div class="span6">
            <h3>Multiple Actions</h3>
            <p>An action is a URL the benchmark requests. Each benchmark can have a single or multiple actions where the actions are defined by the url, the request path, the HTTP method and the parameters. The parameters can either be a fixed value object or a function that generates dynamic parameters for each request.</p>
          </div>
          <div class="span6">
            <h3>Real-Time Analysis</h3>
            <p>The benchmark is fully controlled from a single instance, e.g. the localhost. All bots report their data live to a shared Redis database which means that the current requests per second and average request duration is always up-to-date.</p>
          </div>
        </div>
        <div class="row">
          <div class="span6">
            <h3>Technology Stack</h3>
            <p>The framework is written in pure Javascript and runs on <a href="http://nodejs.org">node.js</a> with <a href="http://code.google.com/p/v8/">V8</a>. With the help of asynchrony it is able to create very high loads. The installation happens through node's packaging system <a href="https://npmjs.org/">npm</a>.</p>
          </div>
          <div class="span6">
            <h3>Why BigBench?</h3>
            <p>We just weren't happy with jMeter or ApacheBench. Especially the usability of jMeter when it comes to distributed testing annoyed us, so we're trying to build something that is easy to use, yet highly performant.</p>
          </div>
        </div>
      </section>
      
      <section id="benchmark">
        <div class="page-header">
          <h1>Benchmark <small>How does it look like?</small></h1>
        </div>
        <p>
          A benchmark is a simply JavaScript file that contains an object. It has to have at least one action. To auto-generate a template like this simply type <code>bigbench.js new</code>. This will create a <code>benchmark.js</code> in the current folder.
        </p>
        <pre>
{
  duration:     120,    // duration in seconds                                                      - default 60
  concurrency:  1,      // number of concurrent requests                                            - default 1
  delay:        0,      // how many milliseconds should be paused between each request (slows down) - default 0
  rampUp:       20,     // how many seconds should it take until all bots are active                - default 0
  actions:[
    {
      name: 'Google Startpage',
      hostname: 'www.google.com',
      path: '/',
      port: 80,
      method: 'GET',
    },
    {
      name: 'Google Search',
      hostname: 'www.google.com',
      path: '/',
      port: 80,
      method: 'GET',
      params: { q: 'southdesign' }
    },
    {
      name: 'Basic Auth Page',
      hostname: 'www.website.com',
      path: '/secret',
      port: 80,
      method: 'GET',
      auth: 'user:password'
    },
    {
      name: 'Function for Dynamic Params',
      hostname: 'www.google.com',
      path: '/',
      port: 80,
      method: 'GET',
      params: function(){
        var index = Math.floor(Math.random() * 3),
            terms = ['one', 'of', 'these'];
        return { q: terms[index] };
      }
    },
    {
      name: 'Posting Content',
      hostname: 'www.google.com',
      path: '/signin',
      port: 80,
      method: 'POST',
      params: { user: 'credentials' }
    }
  ]
}</pre>
    </section>
    
    <section id="setup">
      <div class="page-header" id="setup">
        <h1>Setup <small>What to install?</small></h1>
        <p>
          To run <strong>bigbench.js</strong> you need to have a working node.js installation and a Redis server. The Redis server can either run on a dedicated
          machine or the same machine that is used for controlling the benchmark.
        </p>
        
        <h3>Installation</h3>
        <p>
          Install using npm:
          <pre>sudo npm install bigbench -g</pre>
        </p>
      
        <h3>Configuration</h3>
        <p>
          The only thing the system needs is a connection to a Redis database. By default the bots and controller search for a Redis on <code>localhost:6379</code>
          with no password. To change this you can modify the <code>config.js</code> that has been created with the <code>bigbench.js new</code> command:</p>
          <pre>
module.exports = {
  redis: {
    host: "localhost",
    port: 6379,
    password: "ADD_A_PASSWORD_HERE"
  }
}</pre>
        <p>
          On lauch, the bots and controller search for a <code>config.js</code> in their current working directory and use either the found one, or the default.
        </p>
      
      
        <h3>Local</h3>
        <p>
          To run a test from a single computer, just install bigbench.js and Redis, create a new benchmark, start as many bots as you like and run the benchmark - 
          all on the same machine.
        </p>
      
        <h3>Distributed</h3>
        <p>
          Setup a controller machine with bigbench.js and a Redis that is reachable from the outside. Setup the bot machines with bigbench.js and start the bots.
        </p>
      </div>
    </section>
    
    <section id="control">
      <div class="page-header">
        <h1>Control <small>How to save, start, stop and monitor benchmarks?</small></h1>
        <p>
          The benchmark is controlled and monitored through the command line. The basic workflow is to save a benchmark to the system, then start it and wait for it to finish.
        </p>
        
        <h3>Save</h3>
        <p>
          Before a benchmark is ready to run it has to be saved to the system. This can be done with:
          <pre>bigbench.js save benchmark.js</pre>
          This stores the benchmark for all bots in the Redis database and resets the previously recorded data.
        </p>
        <img src="./img/save.png">
        
        <h3>Start</h3>
        <p>
          To start a benchmark simply run:
          <pre>bigbench.js start</pre>
          The process will return after the duration of the benchmark. If it is cancelled the benchmark is stopped with the current results.
        </p>
        <img src="./img/start.png">
        
        <h3>Stop</h3>
        <p>
          The benchmark stops by default after the duration it is set up. If you need to stop it manually, you can either abort the start process, or run:
          <pre>bigbench.js stop</pre>
          This will end the benchmark with the current results.
        </p>
        <img src="./img/stop.png">
        
        <h3>Monitor</h3>
        <p>
          All information that is available for the benchmark is accessible through the monitor. Simply run:
          <pre>bigbench-monitor.js</pre>
          It will show you the current system status, all available bots and during a run all currently available data.
        </p>
        <img src="./img/monitor.png">
        
        <h3>Start Bot</h3>
        <p>
          To start a bot simply run:
          <pre>bigbench-bot.js</pre>
        </p>
        <img src="./img/start-bot.png">
        
      </div>
    </section>
    
    <section id="data">
      <div class="page-header">
        <h1>Data and Events <small>How to subscribe and analyze the results?</small></h1>
        <p>
          The produced benchmark data is available through two ways: It is permanently stored until the next run and published during the run. The publishing
          is done with Redis' pub/sub implementation, the storage is done using the different data types.
        </p>
        
        <h3>Event System</h3>
        <p>
          To receive messages from the system you can subscribe to different channels that deliver different types of events with data:
        </p>
        
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Channel</th>
              <th>Message</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>bigbench_bots_start</b></td>
              <td><code>ALL</code> or <code>81046c4115f4ef7846cd2f71a1f5829e005e4af1</code></td>
              <td>The start signal for either all bots or a single bot with the bot ID</td>
            </tr>
            <tr>
              <td><b>bigbench_bots_stop</b></td>
              <td><code>ALL</code> or <code>81046c4115f4ef7846cd2f71a1f5829e005e4af1</code></td>
              <td>The stop signal for either all bots or a single bot with the bot ID</td>
            </tr>
            <tr>
              <td><b>bigbench_bots_status</b></td>
              <td><code>81046c4115f4ef7846cd2f71a1f5829e005e4af1:</code> + <code>READY</code>, <code>STOPPED</code>, <code>RUNNING</code> or <code>KILLED</code></td>
              <td>Each bot publishes his bit ID and a status on a status change</td>
            </tr>
            <tr>
              <td><b>bigbench_benchmark_saved</b></td>
              <td><code>Benchmark JavaScript Closure</code></td>
              <td>The benchmark that was currently saved</td>
            </tr>
            <tr>
              <td><b>bigbench_total_series</b></td>
              <td><code>{"200":1864,"500":5}</code></td>
              <td>The amount of requests for each status code in the last second if benchmark is running</td>
            </tr>
            <tr>
              <td><b>bigbench_total_duration_series</b></td>
              <td><code>{"200":6.34,"500":14}</code></td>
              <td>The average duration in ms of all requests for each status code in the last second if benchmark is running</td>
            </tr>
            <tr>
              <td><b>bigbench_action_INDEX_series</b></td>
              <td><code>{"200":1864,"500":5}</code></td>
              <td>The amount of requests for action number INDEX for each status code in the last second if benchmark is running. INDEX is starting at 0 referencing the first action</td>
            </tr>
            <tr>
              <td><b>bigbench_action_INDEX_duration_series</b></td>
              <td><code>{"200":6.34,"500":14}</code></td>
              <td>The average duration in ms for action number INDEX requests for each status code in the last second if benchmark is running. INDEX is starting at 0 referencing the first action</td>
            </tr>
            <tr>
              <td><b>bigbench_timing</b></td>
              <td><pre>{
  "START":"1358873453200",
  "81046c4115f4ef7846cd2f71a1f5829e005e4af1":1358873503200,
  "STOP":"1358873493200"
}</pre></td>
              <td>The timestamps of the global start, global stop and instance start (only if a ramp up period is set up)</td>
            </tr>
            <tr>
              <td><b>bigbench_statistics</b></td>
              <td><pre>
{
    "TOTAL": {
        "REQUESTS_PER_SECOND": {
            "200": {
                "AVG": 1881.75,
                "MAX": 1983,
                "MIN": 1585
            }
        },
        "DURATIONS_PER_SECOND": {
            "200": {
                "AVG": 0.35,
                "MAX": 0.43,
                "MIN": 0.32
            }
        }
    },
    "ACTION_0": {
        "REQUESTS_PER_SECOND": {
            "200": {
                "AVG": 1881.75,
                "MAX": 1983,
                "MIN": 1585
            }
        },
        "DURATIONS_PER_SECOND": {
            "200": {
                "AVG": 0.35,
                "MAX": 0.43,
                "MIN": 0.32
            }
        }
    }
}
</pre></td>
              <td>The statistics that have been computed for the last benchmark run</td>
            </tr>
          </tbody>
        </table>
        
        
        <h3>Persisted Data</h3>
        <p>
          After a run the data is stored until the next run. The following fields hold the following information:
        </p>
        
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Key</th>
              <th>Type</th>
              <th>Data</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>bigbench_status</b></td>
              <td><em>String</em></td>
              <td><code>RUNNING</code> or <code>nil</code></td>
              <td>Checks if a benchmark is currently running</td>
            </tr>
            <tr>
              <td><b>bigbench_bots</b></td>
              <td><em>Hash</em></td>
              <td>Keys: <code>81046c4115f4ef7846cd2f71a1f5829e005e4af1</code>, Values: <code>STOPPED</code></td>
              <td>All currently available bots with their bot ID and status</td>
            </tr>
            <tr>
              <td><b>bigbench_benchmark</b></td>
              <td><em>String</em></td>
              <td><code>Benchmark JavaScript Closure</code></td>
              <td>The current benchmark</td>
            </tr>
            <tr>
              <td><b>bigbench_total_series</b></td>
              <td><em>List</em></td>
              <td>Index: <code>0</code> = <code>{"200":1864,"500":5}</code><br>Index: <code>1</code> = <code>{"200":1962,"500":2}</code><br>...</td>
              <td>The amount of requests in the specified second. Index is the second of the benchmark starting at 0</td>
            </tr>
            <tr>
              <td><b>bigbench_total_duration_series</b></td>
              <td><em>List</em></td>
              <td>Index: <code>0</code> = <code>{"200":32.1,"500":45.1}</code><br>Index: <code>1</code> = <code>{"200":29.1,"500":31.8}</code><br>...</td>
              <td>The average duration in ms for the requests in the specified second. Index is the second of the benchmark starting at 0</td>
            </tr>
            <tr>
              <td><b>bigbench_action_INDEX_series</b></td>
              <td><em>List</em></td>
              <td>Index: <code>0</code> = <code>{"200":1864,"500":5}</code><br>Index: <code>1</code> = <code>{"200":1962,"500":2}</code><br>...</td>
              <td>The amount of requests for the action number INDEX in the specified second. Index is the second of the benchmark starting at 0</td>
            </tr>
            <tr>
              <td><b>bigbench_action_INDEX_duration_series</b></td>
              <td><em>List</em></td>
              <td>Index: <code>0</code> = <code>{"200":32.1,"500":45.1}</code><br>Index: <code>1</code> = <code>{"200":29.1,"500":31.8}</code><br>...</td>
              <td>The average duration in ms for the requests for action number INDEX in the specified second. Index is the second of the benchmark starting at 0</td>
            </tr>
            <tr>
              <td><b>bigbench_timing</b></td>
              <td><em>String</em></td>
              <td><pre>{
  "START":"1358873453200",
  "81046c4115f4ef7846cd2f71a1f5829e005e4af1":1358873503200,
  "STOP":"1358873493200"
}</pre></td>
              <td>The timestamps of the global start, global stop and instance start (only if a ramp up period is set up)</td>
            </tr>
            <tr>
              <td><b>bigbench_statistics</b></td>
              <td><em>String</em></td>
              <td><pre>
{
    "TOTAL": {
        "REQUESTS_PER_SECOND": {
            "200": {
                "AVG": 1881.75,
                "MAX": 1983,
                "MIN": 1585
            }
        },
        "DURATIONS_PER_SECOND": {
            "200": {
                "AVG": 0.35,
                "MAX": 0.43,
                "MIN": 0.32
            }
        }
    },
    "ACTION_0": {
        "REQUESTS_PER_SECOND": {
            "200": {
                "AVG": 1881.75,
                "MAX": 1983,
                "MIN": 1585
            }
        },
        "DURATIONS_PER_SECOND": {
            "200": {
                "AVG": 0.35,
                "MAX": 0.43,
                "MIN": 0.32
            }
        }
    }
}
</pre></td>
              <td>The statistics that have been computed for the last benchmark run</td>
            </tr>
          </tbody>
        </table>
        
        
      </div>
    </section>
    
    <section id="examples">
      <div class="page-header">
        <h1>Examples <small>Some useful benchmarks</small></h1>
        <p>
          Here are some examples of benchmarks that you might find useful:
        </p>
        
        <h3>#1: Single action on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  1,
  delay:        0,
  rampUp:       0,
  actions:[
    {
      name: 'Local Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a single GET request to <code>http://localhost:80/hello</code> and waits for it to return. Then it starts the next one with no delay. All bots start at the same time.</p>
          
        <h3>#2: Single action with fixed parameters on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  1,
  delay:        0,
  rampUp:       0,
  actions:[
    {
      name: 'Local Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
      params: { say: "hello" }
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a single GET request to <code>http://localhost:80/hello?say=hello</code> and waits for it to return. Then it starts the next one with no delay. All bots start at the same time.</p>
        
        <h3>#3: Single action with dynamic parameters on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  1,
  delay:        0,
  rampUp:       0,
  actions:[
    {
      name: 'Local Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
      params: function(){
        var index     = Math.floor(Math.random() * 3),
            greetings = ['hello', 'goodbye', 'seeyou'];
        return { say: greetings[index] };
      }
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a single GET request to <code>http://localhost:80/hello?say=hello</code> or <code>http://localhost:80/hello?say=goodybe</code> or <code>http://localhost:80/hello?say=seeyou</code>and waits for it to return. Then it starts the next one with no delay and a new set of parameters. All bots start at the same time.</p>
        
        <h3>#4: Multiple actions on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  1,
  delay:        0,
  rampUp:       0,
  actions:[
    {
      name: 'Local Hello Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
    },
    {
      name: 'Local Goodbye Action',
      hostname: 'localhost',
      path: '/goodbye',
      port: 80,
      method: 'GET',
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a single GET request to <code>http://localhost:80/hello</code> and waits for it to return. Then it starts the next one <code>http://localhost:80/goodbye</code> with no delay. After that the first action is requested again. All bots start at the same time.</p>
        
        
        <h3>#5: Throttled action on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  1,
  delay:        20,
  rampUp:       0,
  actions:[
    {
      name: 'Local Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a single GET request to <code>http://localhost:80/hello</code> and waits for it to return. Then it waits 20ms and starts the next one. All bots start at the same time.</p>
        
        <h3>#6: Concurrent action on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  10,
  delay:        0,
  rampUp:       0,
  actions:[
    {
      name: 'Local Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a 10 GET requests to <code>http://localhost:80/hello</code>. When a request returns it immediately starts the next one with no delay. All bots start at the same time.</p>
        
        <h3>#7: Ramp up with single action on localhost</h3>
        <pre>
{
  duration:     120,
  concurrency:  1,
  delay:        0,
  rampUp:       60,
  actions:[
    {
      name: 'Local Action',
      hostname: 'localhost',
      path: '/hello',
      port: 80,
      method: 'GET',
    }
  ]
}</pre>
        <p>Runs a test for 2 minutes. Makes a single GET request to <code>http://localhost:80/hello</code> and waits for it to return. Then it starts the next one with no delay. All bots gradually start in the time period of 1 minute. After 1 minute all bots are active.</p>
        
      </div>
    </section>
    
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="muted credit">Copyright 2013 - All rights reserved by <a href="http://mwaysolutions.com">M-Way Solutions GmbH</a></p>
      </div>
    </div>
    
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>